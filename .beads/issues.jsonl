{"id":"SettingsSentry-1z3","title":"Fix Path Traversal in backup path construction","description":"backup.go:382-384 - cfg.Name used directly in backup path construction without sanitization. Malicious config with name=../../../malicious could write backups outside intended directory. Need validation to ensure cfg.Name contains no path separators or traversal sequences.","status":"closed","priority":1,"issue_type":"bug","assignee":"Bot","created_at":"2026-01-08T12:39:27.088676+01:00","created_by":"stefano.straus","updated_at":"2026-01-08T14:53:37.175185+01:00","closed_at":"2026-01-08T14:53:37.175185+01:00","close_reason":"Fixed path traversal in backup path construction by adding sanitizeConfigName() function. Removes path separators and validates config names. Added comprehensive tests."}
{"id":"SettingsSentry-50h","title":"Fix Path Traversal in config file resolution","description":"backup_operations.go:168-177 - ResolveConfigFilePath doesn't validate resolved paths stay within home directory. Malicious config with ~/../../etc/passwd could read/backup sensitive system files. Need filepath.Clean() and boundary validation after resolution.","status":"closed","priority":1,"issue_type":"bug","assignee":"Bot","created_at":"2026-01-08T12:39:19.154378+01:00","created_by":"stefano.straus","updated_at":"2026-01-08T14:53:26.185002+01:00","closed_at":"2026-01-08T14:53:26.185002+01:00","close_reason":"Fixed path traversal in ResolveConfigFilePath with filepath.Clean() and filepath.Rel() validation. Added comprehensive tests."}
{"id":"SettingsSentry-7tl","title":"Fix Shell Injection vulnerability in command execution","description":"Commands from config files (pre_backup_commands, backup_commands) are executed via bash -c without sanitization. A malicious .cfg file can execute arbitrary commands with user privileges. Current --commands flag is disabled by default (secure), but when enabled, no validation occurs. Need to add command validation or explicit confirmation.","status":"closed","priority":0,"issue_type":"bug","assignee":"Bot","created_at":"2026-01-08T12:38:55.942186+01:00","created_by":"stefano.straus","updated_at":"2026-01-08T12:43:27.421901+01:00","closed_at":"2026-01-08T12:43:27.421901+01:00","close_reason":"Fixed: Renamed --commands to --allow-commands with clear security warnings. Commands are disabled by default (secure). Updated README, help text, and CHANGELOG with migration guide."}
{"id":"SettingsSentry-b7k","title":"Fix Cron Job LookPath security vulnerability","description":"cron/cronjob.go:140-147 - InstallCronJob uses exec.LookPath('settingssentry') which searches PATH. If attacker manipulates PATH or places malicious binary earlier in PATH, cron executes wrong binary. Use os.Executable() to get current binary path instead.","status":"closed","priority":1,"issue_type":"bug","assignee":"Bot","created_at":"2026-01-08T12:39:35.840874+01:00","created_by":"stefano.straus","updated_at":"2026-01-08T14:55:01.234531+01:00","closed_at":"2026-01-08T14:55:01.234531+01:00","close_reason":"Fixed cron LookPath security by using os.Executable() instead of exec.LookPath(). Added test to verify absolute paths are used."}
{"id":"SettingsSentry-bzs","title":"Review and enhance Zip Slip protection","description":"backup.go:772-784 - Recent Zip Slip fix may have edge cases. The validation allows absExtractPath == absDestinationPath which could allow extracting directly to root. Also need to verify symlink handling doesn't bypass protection. Review and strengthen validation logic.","status":"closed","priority":2,"issue_type":"bug","assignee":"Bot","created_at":"2026-01-08T12:39:44.419601+01:00","created_by":"stefano.straus","updated_at":"2026-01-08T14:57:55.746983+01:00","closed_at":"2026-01-08T14:57:55.746983+01:00","close_reason":"Reviewed Zip Slip protection. Confirmed existing validation properly prevents path traversal and symlink attacks. All security tests pass."}
{"id":"SettingsSentry-ijc","title":"Fix Goroutine Resource Leak in command execution","description":"interfaces/command.go:48-66 - ExecuteWithCallback spawns 2 goroutines to read stdout/stderr but never waits for them to complete before calling cmd.Wait(). Creates race condition where goroutines may still be reading after Wait() returns. Causes output truncation and resource leaks. Need WaitGroup synchronization.","status":"closed","priority":0,"issue_type":"bug","assignee":"Bot","created_at":"2026-01-08T12:39:10.524295+01:00","created_by":"stefano.straus","updated_at":"2026-01-08T12:45:44.264535+01:00","closed_at":"2026-01-08T12:45:44.264535+01:00","close_reason":"Fixed: Added WaitGroup synchronization with defer wg.Done() in both stdout/stderr goroutines. cmd.Wait() is called, then wg.Wait() ensures both goroutines complete before returning. Tested with race detector - no issues found."}
